<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Ruckig: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Ruckig
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   <div id="projectbrief">Online Trajectory Generation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Ruckig Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div align="center"> <h1 align="center">Ruckig</h1>
</div><div align="center"> <h3 align="center">Online Trajectory Generation. Real-time. Time-optimal. Jerk-constrained. </h3>
</div><div align="center"> </div> <p><a href="https://github.com/pantor/ruckig/actions"></a></p>
<p><a href="https://github.com/pantor/ruckig/issues"></a></p>
<p><a href="https://github.com/pantor/ruckig/releases"></a></p>
<p><a href="https://github.com/pantor/ruckig/blob/master/LICENSE"></a> </p>
<p>Ruckig calculates a time-optimal trajectory given a <em>target</em> waypoint with position, velocity, and acceleration starting from <em>any</em> initial state limited by velocity, acceleration, and jerk constraints. Ruckig is a more powerful and open-source alternative to the <a href="http://reflexxes.ws/">Reflexxes Type IV</a> library. In fact, Ruckig is a Type V trajectory generator. For robotics and machining applications, Ruckig allows both instant reactions to unforeseen events as well as simple offline trajectory planning.</p>
<h2>Installation</h2>
<p>Ruckig has no dependencies for practical usage. To build Ruckig using CMake, just run</p>
<div class="fragment"><div class="line">mkdir -p build</div><div class="line">cd build</div><div class="line">cmake -DCMAKE_BUILD_TYPE=Release ..</div><div class="line">make</div></div><!-- fragment --><p>To install Ruckig in a system-wide directory, use <code>(sudo) make install</code>. We recommend to include Ruckig as a directory within your project and call <code>add_subdirectory(ruckig)</code> in your main <code>CMakeLists.txt</code>. A python module can be built using the <code>BUILD_PYTHON_MODULE</code> CMake flag.</p>
<h2>Tutorial</h2>
<p>Furthermore, a tutorial will explain the basics to include online generated trajectories within your robotics or machining application. A working example can be found in the <code>examples</code> directory. A time-optimal trajectory for a single degree of freedom is shown in the figure below.</p>
<div class="image">
<img src="https://github.com/pantor/ruckig/raw/master/doc/example_profile.png?raw=true" alt="Trajectory Profile"/>
</div>
<h3>Real-time trajectory generation</h3>
<p>Ruckig provides three interface classes: the <em>Ruckig</em>, the <em>InputParameter</em>, and the <em>OutputParameter</em> class.</p>
<p>First, you'll need to create a Ruckig instance with the number of DoFs as a template parameter, and the control cycle in seconds in the constructor.</p>
<div class="fragment"><div class="line">Ruckig&lt;6&gt; <a class="code" href="namespaceruckig.html">ruckig</a> {0.001}; <span class="comment">// Number DoFs; control cycle in [s]</span></div></div><!-- fragment --><p>The input type has 3 blocks of data: the <em>current</em> state, the <em>target</em> state and the corresponding dynamical <em>limits</em>.</p>
<div class="fragment"><div class="line">InputParameter&lt;6&gt; input; <span class="comment">// Number DoFs</span></div><div class="line">input.current_position = {0.2, ...};</div><div class="line">input.current_velocity = {0.1, ...};</div><div class="line">input.current_acceleration = {0.1, ...};</div><div class="line">input.target_position = {0.5, ...};</div><div class="line">input.target_velocity = {-0.1, ...};</div><div class="line">input.target_acceleration = {0.2, ...};</div><div class="line">input.max_velocity = {0.4, ...};</div><div class="line">input.max_acceleration = {1.0, ...};</div><div class="line">input.max_jerk = {4.0, ...};</div><div class="line"></div><div class="line">OutputParameter&lt;6&gt; output; <span class="comment">// Number DoFs</span></div></div><!-- fragment --><p>Given all input and output resources, we can iterate over the trajectory at each discrete time step. For most applications, this loop must run within a real-time thread and controls the actual hardware.</p>
<div class="fragment"><div class="line">while (otg.update(input, output) == Result::Working) {</div><div class="line">  // Make use of the new dynamic state here!</div><div class="line"></div><div class="line">  input.current_position = output.new_position;</div><div class="line">  input.current_velocity = output.new_velocity;</div><div class="line">  input.current_acceleration = output.new_acceleration;</div><div class="line">}</div></div><!-- fragment --><p>During your update step, you'll need to copy the new dynamic state into the current state. If the current state is not the expected, pre-calculated trajectory, ruckig will calculate a new trajectory with the new input. When the trajectory has finished, the <code>update</code> function will return <code>Result::Finished</code>.</p>
<h3>Input Parameter</h3>
<p>To go into more detail, the <em>InputParameter</em> type has following members:</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> Vector = std::array&lt;double, DOFs&gt;;</div><div class="line"></div><div class="line">Vector current_position;</div><div class="line">Vector current_velocity; <span class="comment">// Initialized to zero</span></div><div class="line">Vector current_acceleration; <span class="comment">// Initialized to zero</span></div><div class="line"></div><div class="line">Vector target_position;</div><div class="line">Vector target_velocity; <span class="comment">// Initialized to zero</span></div><div class="line">Vector target_acceleration; <span class="comment">// Initialized to zero</span></div><div class="line"></div><div class="line">Vector max_velocity;</div><div class="line">Vector max_acceleration;</div><div class="line">Vector max_jerk;</div><div class="line"></div><div class="line">std::array&lt;bool, DOFs&gt; enabled; <span class="comment">// Initialized to true</span></div><div class="line">std::optional&lt;double&gt; minimum_duration;</div><div class="line">std::optional&lt;Vector&gt; min_velocity; <span class="comment">// If not given, the negative maximum velocity will be used.</span></div></div><!-- fragment --><p>The members are implemented using the C++ standard libraries <code>array</code> and <code>optional</code> type. Note that there are some range constraints due to numerical reasons, you can read below for more details. To check the input in front of a calculation step, the <code>ruckig.validate_input(input)</code> method returns <code>false</code> if an input is not valid. Of course, the target state needs to be within the given dynamic limits. Additionally, the target acceleration needs to fulfill </p><div class="fragment"><div class="line">target_acceleration &lt;= Sqrt(2 * max_jerk * (max_velocity - Abs(target_velocity)))</div></div><!-- fragment --><p> If a DoF is not enabled, it will be ignored in the calculation. A minimum duration can be optionally given. Furthermore, the minimum velocity can be specified. If it is not given, the negative maximum velocity will be used (similar to the acceleration and jerk limits). For example, this might be useful in human robot collaboration settings with a different velocity limit towards a human.</p>
<h3>Result Type</h3>
<p>The <code>update</code> function of the Ruckig class returns a Result type that indicates the current state of the algorithm. Currently, this can either be <b>working</b>, <b>finished</b> if the trajectory has finished, or an <b>error</b> type if something went wrong during calculation. The result type can be compared as a standard integer.</p>
<table class="doxtable">
<tr>
<th>State </th><th>Error Code  </th></tr>
<tr>
<td>Working </td><td>0 </td></tr>
<tr>
<td>Finished </td><td>1 </td></tr>
<tr>
<td>Error </td><td>-1 </td></tr>
<tr>
<td>ErrorInvalidInput </td><td>-100 </td></tr>
<tr>
<td>ErrorTrajectoryDuration </td><td>-101 </td></tr>
<tr>
<td>ErrorExecutionTimeCalculation </td><td>-110 </td></tr>
<tr>
<td>ErrorSynchronizationCalculation </td><td>-111 </td></tr>
</table>
<h3>Output Parameter</h3>
<p>The output class gives the new dynamical state of the trajectory.</p>
<div class="fragment"><div class="line">std::array&lt;double, DOFs&gt; new_position;</div><div class="line">std::array&lt;double, DOFs&gt; new_velocity;</div><div class="line">std::array&lt;double, DOFs&gt; new_acceleration;</div><div class="line"></div><div class="line"><span class="keywordtype">double</span> duration; <span class="comment">// Duration of the trajectory [s]</span></div><div class="line"><span class="keywordtype">bool</span> new_calculation; <span class="comment">// Whether a new calactuion was performed in the last cycle</span></div><div class="line"><span class="keywordtype">double</span> calculation_duration; <span class="comment">// Duration of the calculation in the last cycle [Âµs]</span></div><div class="line"></div><div class="line">std::array&lt;double, DOFs&gt; independent_min_durations; <span class="comment">// [s]</span></div></div><!-- fragment --><p> Moreover, a range of additional parameter about the duration of the trajectory are included.</p>
<h2>Tests and Numerical Stability</h2>
<p>The current test suite validates over 1.206.000 (random) trajectories. The numerical exactness is tested for the final position and final velocity to be within <code>1e-8</code>, for the velocity and acceleration limit to be withing <code>1e-9</code>, and for the final acceleration as well as jerk limit to be within a numerical error of <code>1e-12</code>. Ruckig presumes that the input values are within 5 orders of magnitude and that <code>jMax &gt; 5e-2</code>. Note that Ruckig will also output values outside of this range, there is however no guarantee for correctness. The maximal supported trajectory duration is <code>1e12</code>.</p>
<h2>Development</h2>
<p>Ruckig is written in C++17. It is currently tested against following versions</p>
<ul>
<li>Catch2 v2.13.3 (only for testing)</li>
<li>Reflexxes v1.2.7 (only for comparison)</li>
<li>Pybind11 v2.6.0 (only for python wrapper)</li>
</ul>
<h2>Citation</h2>
<p>A publication for citation will follow ;) </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
